<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="ProjectStats">
	<typeAlias alias="ProjectStats" type="com.neusoft.model.udmgr.dao.pojo.ProjectStats" />
	<insert id="insert" parameterClass="ProjectStats">
		insert into PROJECT_STATS
			(STATS_ID,PROJECT_ID,MILESTONE_NAME,PLAN_START,PLAN_END,
			REALITY_START,REALITY_END,MILESTONE_STATS,PLAN_VERSION)
		values
			(#statsId#,#projectId#,#milestoneName#,
			#planStart:DATE#,#planEnd:DATE#,#realityStart:DATE#,#realityEnd:DATE#,
			#milestomeStats:VARCHAR#,#planVersion:VARCHAR#)
	</insert>
	<update id="updateById" parameterClass="ProjectStats">
		update 
			PROJECT_STATS 
		set
			PROJECT_ID = #projectId#,MILESTONE_NAME = #milestoneName#,
			PLAN_START = #planStart:DATE#,PLAN_END=#planEnd:DATE#,
			REALITY_START=#realityStart:DATE#,REALITY_END=#realityEnd:DATE#,
			MILESTONE_STATS=#milestomeStats:VARCHAR#,PLAN_VERSION=#planVersion:VARCHAR#
		where 
			STATS_ID = #statsId#
	</update>
	<delete id="delete" parameterClass="ProjectStats">
		DELETE FROM 
			PROJECT_STATS
		WHERE
			PROJECT_ID = #projectId#  AND
			MILESTONE_NAME = #milestoneName#
	</delete>
	<select id="query_by_projectId" parameterClass="string" resultClass="ProjectStats">
		SELECT 
			p.STATS_ID AS statsId,p.PROJECT_ID AS projectId,
			p.MILESTONE_NAME AS milestoneName,p.PLAN_START AS planStart,
			p.PLAN_END AS planEnd,p.REALITY_START AS realityStart,
			p.REALITY_END AS realityEnd,p.MILESTONE_STATS as milestomeStats,
			p.PLAN_VERSION AS planVersion,d.ENTRY_NAME as  milestoneDes
		FROM
			PROJECT_STATS p
		LEFT JOIN
			DICT_CATALOG d ON d.CATALOG_ID = p.MILESTONE_NAME
		WHERE
			p.PROJECT_ID = #value#
		ORDER BY d.ENTRY_ORDER
	</select>
</sqlMap>
